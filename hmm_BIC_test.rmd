---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
set.seed(1234)
n_states = 5
n_time = 2000


#tran.m.true <- matrix(unlist(x1), ncol = n_states, byrow = T)
#apply(tran.m, 1, sum)
tran.m.true <- matrix(c(1/2, 1/2, 0, 0, 0,
                        1/3, 1/3, 1/3, 0, 0,
                        0, 1/3, 1/3, 1/3, 0, 
                        0, 0, 1/3, 1/3, 1/3, 
                        0, 0, 0, 1/2, 1/2), byrow=TRUE, nrow=5)
listofnormals = list()
listofnormals[[1]] = list(1, 'mean' = 2, 'sd' = 1 )
listofnormals[[2]] = list(1, 'mean' = 4, 'sd' = 1 )
listofnormals[[3]] = list(1, 'mean' = 8, 'sd' = 1 )
listofnormals[[4]] = list(1, 'mean' = 14, 'sd' = 1 )
listofnormals[[5]] = list(1, 'mean' = 10, 'sd' = 1 )
ini.vec = c(1, 0, 0, 0,0)
obs.vec = rep(NA, n_time)
obs.states = rep(NA, n_time)

for (i in 1:n_time) {
  x <- sample(1:n_states, 1, prob = ini.vec)
  obs.states[i] <- x
  obs.vec[i] = do.call(rnorm, listofnormals[[x]])
  ini.vec <- ini.vec %*% tran.m.true
}

obs.states
tran.m.true
```

```{r}
hmm_BIC(obs.vec, 100)
```
```{r}
sm <- mean(obs.vec)
sv <- var(obs.vec)
n = length(obs.vec)
n
sm
sv
```
```{r}
rinvgamma(1,shape = (n-1)/2, scale = (n-1)*sv/2)

```
```{r}
rinvgamma(1,shape = (n-1)/2, rate = (n-1)*sv/2)
```




